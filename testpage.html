<!DOCTYPE html>
<html>
<head>
	<title>Test Page</title>
	<link rel="manifest" href="/manifest.json" />
	<script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script>
	<script>
  	var OneSignal = window.OneSignal || [];
  	OneSignal.push(function() {
    	OneSignal.init({
      	appId: "3beb3078-e0f1-4629-af17-fde833b9f716",
    	});
    	OneSignal.showSlidedownPrompt();
  	});
	</script>
</head>
<body>
	<script>
			OneSignal.push(function() {
  			// Occurs when the user's subscription changes to a new value.
  			OneSignal.on('subscriptionChange', function (isSubscribed) {
    			console.log("The user's subscription state is now:", isSubscribed);
          OneSignal.getUserId(function(id) {
            console.log(id);
            if (isSubscribed === true) {
              var xhttp = new XMLHttpRequest();
              xhttp.open("POST", "https://onesignal.com/api/v1/notifications", true);
              xhttp.setRequestHeader({
                "Content-type", "application/json",
                "Access-Control-Allow-Origin","*"
              });
              xhttp.send({
                "app_id":"3beb3078-e0f1-4629-af17-fde833b9f716",
                "contents": {"en": "New Subscriber"},
                "include_player_ids":[id]
              });
            }
          })
  			});
			});
	</script>

</body>
</html>